<!DOCTYPE html>
<html>
<head>
	<title>Daily Fuel Price</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"> </script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocas-ui/2.3.3/tocas.css">
	<style>
	body {
		padding: 15px;	
	}
	.fuel {
		max-width: 500px;
		margin: 5% auto !important;
	}
	.mss {
		display: none;	
	}
</style>
</head>
<body>


	<div class="ts primary card fuel">
		<div class="content">
			<div class="header">
				Check Fuel Price in India
			</div>
			<div class="description">
				<div class="ts form">
					<div class="field">
						<select id="city" name="city">
							<option value="" disabled selected>
								Pick a city
							</option>
							{% for city in city_list | sort %}
								<option value="{{ city }}">
									{{ city }}
								</option>
							{% endfor %}
						</select> 
					</div>
					<div class="field">
						<select id="fuel" name="fuel">
							<option value="" disabled selected>
								Pick a fuel type
							</option>
							{% for fuel in fuel_type | sort %}
								<option value="{{ fuel }}">
									{{ fuel }}
								</option>
							{% endfor %}
						</select>
					</div>
					<button class="ts positive basic button" onclick="obtain_price()">Show Price</button>
					<div id="information_status" class="ts positive card mss">
						<div class="content">
							<div class="description" id="result"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
<script>
	$("#information_status").hide();
	function obtain_price() {
		$("#information_status").fadeIn();
		$("#result").text("Attempting to obtain price");
		jsonData = {};
		$.ajax({
			type: "GET",
			dataType: "JSON",
			data: jsonData,
			url: "v1/price/"+$('#city').val()+"/"+$('#fuel').val(),
			success: function(data) {
				$("#result").text("Latest Price for " + $('#fuel').val() + " in " + $('#city').val() + " is Rs. " + data["price"]);
			},
			error: function(data) {
				validate_fields();
			}
		});
	}

	function validate_fields() {
		var message = $("#result").text("Ups. Something wrong happen. Unable to fetch data. Try again.");
		var city = $("#city").val();
		var fuel = $("#fuel").val();
		if ((city == null) || (fuel == null)) {
			message = $("#result").text("It looks like you have not entered yet the city or the fuel type. Please do so :D");
		}
		return message;
	}
</script>
</body>
</html>
